# 中介者通信契约

## 概述
此契约定义了在ModularGodot.Core框架中测试通过中介者模式进行通信的预期行为。

## 契约要求

### 命令处理
- 中介者必须成功将命令请求路由到相应的处理器
- 命令处理器必须接收包含所有数据的正确命令实例
- 命令执行必须在指定的超时约束内完成
- 命令结果必须按照处理器指定的方式返回给调用者

### 查询处理
- 中介者必须成功将查询请求路由到相应的处理器
- 查询处理器必须接收包含所有数据的正确查询实例
- 查询执行必须在指定的超时约束内完成
- 查询结果必须按照处理器指定的方式返回给调用者

### 错误处理
- 处理器抛出的异常必须传播回给调用者
- 未找到处理器的场景必须导致适当的异常
- 超时场景必须根据配置进行处理

### 性能要求
- 命令路由时间必须小于1毫秒（简单命令）
- 查询路由时间必须小于1毫秒（简单查询）
- 中介者操作期间内存使用量不得显著增加

## 测试场景

### 成功的命令执行
**前提**：为特定命令类型注册了命令处理器
**当**：通过中介者发送该类型的命令
**则**：处理器被调用并返回预期结果

### 成功的查询执行
**前提**：为特定查询类型注册了查询处理器
**当**：通过中介者发送该类型的查询
**则**：处理器被调用并返回预期结果

### 未找到处理器
**前提**：没有为特定命令/查询类型注册处理器
**当**：通过中介者发送该类型的命令/查询
**则**：抛出适当的异常

### 异常传播
**前提**：注册的处理器抛出异常
**当**：通过中介者向该处理器发送命令/查询
**则**：异常传播回给调用者